<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/admin-style.css" />
    <link rel="stylesheet" href="../CSS/unidade.css">
    <title>Unidades</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
</head>

<body>
    <!-- HEADER PUMPDRINK -->
    <div class="header">
        <div class="container">

            <div>
                <img src="../assets/logo.png" class="logo">
                <img src="../assets/text_logo.png" class="logo">
            </div>

            <div class="search-bar">
                <input type="search" placeholder="Pesquisar">
                <button type="submit">
                    <img src="../assets/pesquisar.png">
                </button>
            </div>

            <ul class="navbar">
                <li><a href="">DASHBOARD</a></li>
                <li><a href="">BEBIDAS</a></li>
                <li><a href="">UNIDADES</a></li>
            </ul>


            <div class="perfil_header">
                <img src="../assets/notification.png"> <!--icone notificação -->
                <h5>USER CLIENTE</h5>
                <img src="../assets/seta.png" id="seta_user">
            </div>

        </div>
    </div>

    <!-- UNIDADES -->
    <div class="unidade">
        <div class="container" id="div_container_unidade">
            <span class="titulo">
                Desempenho das unidades
            </span>
            <div class="topo">
                <div class="metrica">
                    <span id="muito_baixo"> Muito Baixo</span>
                    <span id="baixo">Baixo</span>
                    <span id="quase">Quase</span>
                    <span id="esperado">Esperado</span>
                    <span id="alto">Alto</span>
                </div>

                <button>Adicionar Unidade</button>
                <Select id="select">
                    <option value="Coca-cola">Coca-cola</option>
                </Select>
            </div>
            <div class="card_unidade">
                <div class="card muito_baixo">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
                <div class="card muito_baixo">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
            </div>
            <div class="card_unidade">
                <div class="card baixo">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
                <div class="card baixo">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
            </div>
            <div class="card_unidade">
                <div class="card quase">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
                <div class="card quase">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
            </div>
            <div class="card_unidade">
                <div class="card esperado">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
                <div class="card esperado">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
            </div>
            <div class="card_unidade">
                <div class="card alto">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
                <div class="card alto">
                    <span>Starbucks Haddock Lobo</span>
                    <p>Rua Haddock Lobo, 608 - Cerqueira César - 00000-000 - São Paulo - SP</p>
                    <span>Bebida: Coca-cola</span>
                    <div class="meta">
                        <span>Total Saídas: 100</span>
                        <span>Meta: 800 </span>
                        <span>Semanas restantes: 100</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- FOOTER PUMPDRINK -->
    <div class="footer">
        <div class="container">
            <h4>©PumpDrink 2023</h4>
        </div>
    </div>


</body>

</html>

<script>
    function alerta() {

        var bebida = select.value

        fetch(`/unidade/:${bebida}`, { cache: 'no-store' }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));

                    unidades = json;

                    setTimeout(function () {
                        unidade(unidades)
                    }, 1000); // apenas para exibir o loading

                });

            } else {

                console.log("Houve um erro ao tentar realizar o login!");

                
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;


    }
    function unidade(resultado) {
        for (var i = 0; i < resultado.length; i += 2) {

            var cor_card1 = ''
            var unidade1 = resultado[i].unidade
            var endereco1 = resultado[i].endereco
            var bebida = select.value
            var desempenho1 = resultado[i].saidas
            var meta = 10
            var prazo = 2024
            var cor_card2 = ''
            var unidade2 = resultado[i + 1].unidade
            var endereco2 = resultado[i + 1].endereco
            var desempenho2 = resultado[i + 1].saidas


            if (resultado[i].desempenho <= meta*0.25) {
                cor_card1 = 'muito_baixo'
            } else if (resultado[i].desempenho <= meta*5) {
                cor_card1 = 'baixo'
            } else if (resultado[i].desempenho <= meta*0.75) {
                cor_card1 = 'quase'
            } else if (resultado[i].desempenho <= meta) {
                cor_card1 = 'esperado'
            } else if (resultado[i].desempenho > meta) {
                cor_card1 = 'acima'
            }
            if (resultado[i + 1].desempenho <= meta*0.25) {
                cor_card2 = 'muito_baixo'
            } else if (resultado[i + 1].desempenho <= meta*0.5) {
                cor_card2 = 'baixo'
            } else if (resultado[i + 1].desempenho <= meta*0.75) {
                cor_card2 = 'quase'
            } else if (resultado[i + 1].desempenho <= meta) {
                cor_card2 = 'esperado'
            } else if (resultado[i + 1].desempenho > meta) {
                cor_card2 = 'acima'
            }

            if (i + 1 < resultado.length) {

                div_container_unidade += `
                <div class="card_unidade">
                    <div class="card ${cor_card1}">
                        <span>${unidade1}</span>
                        <p>${endereco1}</p>
                        <span>Bebida: ${bebida}</span>
                        <div class="meta">
                            <span>Total Saídas: ${desempenho1}</span>
                            <span>Meta: ${meta} </span>
                            <span>Semanas restantes: ${prazo}</span>
                        </div>
                    </div>
                    <div class="card ${cor_card2}">
                        <span>${unidade2}</span>
                        <p>${endereco2}</p>
                        <span>Bebida: ${bebida}</span>
                        <div class="meta">
                            <span>Total Saídas: ${desempenho2}</span>
                            <span>Meta: ${meta} </span>
                            <span>Semanas restantes: ${prazo}</span>
                        </div>
                    </div>
                </div>
                `
            } else {
                div_container_unidade += `
                <div class="card_unidade">
                    <div class="card ${cor_card1}">
                        <span>${unidade1}</span>
                        <p>${endereco1}</p>
                        <span>Bebida: ${bebida}</span>
                        <div class="meta">
                            <span>Total Saídas: ${desempenho1}</span>
                            <span>Meta: ${meta} </span>
                            <span>Semanas restantes: ${prazo}</span>
                        </div>
                    </div>
                </div>
                `
            }
        }
    }
</script>