<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="assets/3.png" type="image/x-icon" />
  <link rel="stylesheet" href="./CSS/style.css">
  <link rel="stylesheet" href="./CSS/login.css">
  <title>Pump Drink | Login</title>
</head>

<body>
  <!-- HEADER PUMPDRINK -->
  <div class="header">
    <div class="container-header">
      <div>
        <a href="index.html"><img src="./assets/logo.png" href="index.html" class="ppdrink" /></a>
      </div>
      <div>
        <a href="index.html"><img src="./assets/text_logo.png" href="index.html" class="ppdrink" /></a>
      </div>

      <ul class="navbarLista">
        <li><a href="index.html">HOME</a></li>
        <li><a href="">SOBRE NÓS</a></li>
        <li><a href="simule.html">SIMULE</a></li>
        <li><a href="">CONTATE-NOS</a></li>
        <a href="login.html" class="loginBtn">
          <li><b>Login</b></li>
        </a>
      </ul>
    </div>
  </div>

  <div class="card_erro" id="cardErro">
    <span id="mensagem_erro"></span>
  </div>
  
  <!-- LOGIN -->
  <div class="containerGeralhome">
    <div class="container-2">
      <div class="login">
        <h1>
          Cadastro de Bebidas
        </h1>
        <div class="label-float">
          <label class="nome" type="text"  placeholder=" Sua bebida " >Nome</label>
          <input id="ipt_nomeBebida" for="usuario">
        </div>
        <div class="label-float">
          <label class="tipo" type="text" placeholder=" Tipo" >Tipo</label>
          <select id="combo_tipo">
            <option value="*"></option>
            <option value="">Pré Treino</option>
              <option value=""> Pós Treino </option>
          </select>
          </div>
              <div class="label-float">
          <label class="prazo_inicial" type="text"  placeholder="De" >Prazo Inicial</label>
          <input id="ipt_prazo_inicial" for="usuario">
          </div>
          <div class="label-float">
          <label class="prazo_final" type="text" placeholder="Até" >Prazo Final</label>
          <input id="ipt_prazo_final" for="usuario">
              </div>     
                 
              <div class="label-float">
          <label class="metaGeral" type="text" placeholder="Meta" >Meta Geral</label>
          <input id="ipt_meta_Geral" for="usuario">
          </div>
          <div class="label-float">
          <label class="metaSemanal" type="text"  placeholder="Meta Semanal " >Meta Semanal</label>
          <input id="ipt_meta_semanal" for="usuario">
          </div>
          <p>Lembre-se de que a meta vai ser um parametro para medir o desempenho. *É importante que seja realista.</p>

        <div class="container-btn">
          <div class='btn-forms'>
            <button onclick="validacaoCadastroBebidas()" type="submit" class="btn_cadastroBebidas">Entrar</button>
          </div>

      </div>
    </div>
  </div>
  <!-- FOOTER PUMPDRINK -->

  <div class="footer">
    <div class="footerContainer">

      <p> » Blog </p>
      <p class="paragrafoFooter"> » Trabalhe Conosco </p>
      <p class="paragrafoFooter"> <span><b>Contato:</b></span> (55+) 11-9444-9898 </p>
      <p class="paragrafoFooter"> <span><b>Horário:</b></span> Segunda a Sexta - 10:30h às 16:30h </p>
      <p> <span><b>E-mail:</b></span>PumpDrink@gmail.com </p>
    </div>
    <div class="container-1">
      <p class="paragrafoFooter"><span><b>Endereço:</b></span> Rua Haddock Lobo, 595 São Paulo - SP</p>
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3657.287345323343!2d-46.66418892499157!3d-23.558121278802066!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94ce59d2b063f663%3A0xc567c0d16d0bc582!2sS%C3%A3o%20Paulo%20Tech%20School!5e0!3m2!1spt-BR!2sbr!4v1681743959247!5m2!1spt-BR!2sbr"
        width="260" height="245" style="border:0;" allowfullscreen="" loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <div class="container-3">
      <p>
        ©PumpDrink 2023. Todos os direitos reservados.
      </p>
    </div>

  </div>

</body>

</html>
<script>



  function validacaoLogin() {

    var emailVar = ipt_email.value;
    var senhaVar = ipt_password.value;

    if (senhaVar.length < 6 || senhaVar == "") {
      cardErro.style.display = "block";
      mensagem_erro.innerHTML = 'Senha *Insira no minimo 6 caracteres';
      return false;
    } else if (!emailVar.includes("@") || emailVar == "" || !emailVar == ('.')) {
      cardErro.style.display = "block";
      mensagem_erro.innerHTML = 'Digite Corretamente seu E-mail';
      return false;
    } else {
      mensagem_erro.innerHTML = "Valeu pelo cadastro, bora iniciar?"
      setInterval(sumirMensagem, 5000)
      window.location.href = "./admin/dashboard.html"            // setInterval(sumirMensagem, 5000) //função assincrona tempo de intervalo
      return true;
    }
  }

  function entrar() {
    aguardar();
    validacaoLogin();

    console.log("FORM LOGIN: ", emailVar);
    console.log("FORM SENHA: ", senhaVar);

    fetch("/usuarios/autenticar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        emailServer: emailVar,
        senhaServer: senhaVar
      })
    }).then(function (resposta) {
      console.log("ESTOU NO THEN DO entrar()!")

      if (resposta.ok) {
        console.log(resposta);

        resposta.json().then(json => {
          console.log(json);
          console.log(JSON.stringify(json));

          sessionStorage.EMAIL_USUARIO = json.email;
          sessionStorage.NOME_USUARIO = json.nome;
          sessionStorage.ID_USUARIO = json.id; 
          sessionStorage.CPF_USUARIO = json.cpf;

          setTimeout(function () {
            window.location = "./admin/dashboard.html";
          }, 1000); // apenas para exibir o loading

        });

      } else {

        console.log("Houve um erro ao tentar realizar o login!");

        resposta.text().then(texto => {
          console.error(texto);
          finalizarAguardar(texto);
        });
      }

    }).catch(function (erro) {
      console.log(erro);
    })

    return false;
  }

  function sumirMensagem() {
    cardErro.style.display = "none"
  }

  document.addEventListener('keypress', function (e) {
    if (e.which == 13) {
    }
  }, false);    //Fazendo o enter funcionar quando da um Enter no input


</script>